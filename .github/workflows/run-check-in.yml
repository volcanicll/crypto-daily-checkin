name: Crypto Daily CheckIn

on:
  schedule:
    # 每天UTC时间1:00 AM，北京时间9:00 AM
    - cron: "0 1 * * *"
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    env:
      COINGECKO_COOKIE: ${{secrets.COINGECKO_COOKIE}}
      COINGECKO_TOKEN: ${{secrets.COINGECKO_TOKEN}}
      COINMARKET_COOKIE: ${{secrets.COINMARKET_COOKIE}}
      COINMARKET_TOKEN: ${{secrets.COINMARKET_TOKEN}}
      WX_COMPANY_ID: ${{secrets.WX_COMPANY_ID}}
      WX_APP_ID: ${{secrets.WX_APP_ID}}
      WX_APP_SECRET: ${{secrets.WX_APP_SECRET}}
      BOT_KEY: ${{secrets.BOT_KEY}}
      TELEGRAM_BOT_TOKEN: ${{secrets.TELEGRAM_BOT_TOKEN}}
      TELEGRAM_CHAT_ID: ${{secrets.TELEGRAM_CHAT_ID}}
      LLM_API_KEY: ${{secrets.LLM_API_KEY}}
      LLM_BASE_URL: ${{secrets.LLM_BASE_URL}}
      LLM_MODEL: ${{secrets.LLM_MODEL}}
      DINGTALK_SECRET: ${{secrets.DINGTALK_SECRET}}
      DINGTALK_ACCESS_TOKEN: ${{secrets.DINGTALK_ACCESS_TOKEN}}
      MODULE_GOLD: ${{secrets.MODULE_GOLD}}
      MODULE_CRYPTO: ${{secrets.MODULE_CRYPTO}}
      MODULE_AI_NEWS: ${{secrets.MODULE_AI_NEWS}}
      MODULE_LLM_COMMENTARY: ${{secrets.MODULE_LLM_COMMENTARY}}
      MODULE_WEATHER: ${{secrets.MODULE_WEATHER}}
      MODULE_QUOTE: ${{secrets.MODULE_QUOTE}}
      NOTIFY_TELEGRAM: ${{secrets.NOTIFY_TELEGRAM}}
      NOTIFY_DINGTALK: ${{secrets.NOTIFY_DINGTALK}}
      NOTIFY_WX_BOT: ${{secrets.NOTIFY_WX_BOT}}
      NOTIFY_WX_APP: ${{secrets.NOTIFY_WX_APP}}

    steps:
      - name: checkout
        uses: actions/checkout@v4

      - name: setup bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest

      - name: install dependencies
        run: bun install

      - name: run js
        run: bun run start
